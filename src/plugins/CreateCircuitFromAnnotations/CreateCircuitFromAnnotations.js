/*globals define*/
/*eslint-env node, browser*/

/**
 * Generated by PluginGenerator 2.20.5 from webgme on Thu Apr 07 2022 13:59:26 GMT-0500 (Central Daylight Time).
 * A plugin that inherits from the PluginBase. To see source code documentation about available
 * properties and methods visit %host%/docs/source/PluginBase.html.
 */

define([
    'plugin/PluginConfig',
    'text!./metadata.json',
    'plugin/PluginBase',
    'electric-circuits/AnnotationWJIToCircuitTransformer',
    'webgme-json-importer/JSONImporter',
], function (
    PluginConfig,
    pluginMetadata,
    PluginBase,
    AnnotationWJIToCircuitTransformer,
    JSONImporter,) {
    'use strict';

    pluginMetadata = JSON.parse(pluginMetadata);

    class CreateCircuitFromAnnotations extends PluginBase {
        constructor(props) {
            super(props);
            this.pluginMetadata = pluginMetadata;
        }

        async main() {
            const annotationWJI = await this.blobClient.getObjectAsJSON(this.getCurrentConfig().annotations);
            const circuitWJITransformer = new AnnotationWJIToCircuitTransformer();
            circuitWJITransformer.transform(annotationWJI);
            const importer = new JSONImporter(this.core, this.rootNode);
            await importer.import(this.activeNode, annotationWJI);
            await this.save('Model updated to new state.');
            this.result.setSuccess(true);
        }
    }



    return CreateCircuitFromAnnotations;
});
